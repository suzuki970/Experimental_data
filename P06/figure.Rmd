---
title: "Result notes"
author: "Yuta Suzuki"
date: "4/23/2021"
output: html_document
     # reference_docx: results.docx
     # word_document
---
<style type="text/css">
body{
font-size: 14pt;
line-height: 2;
width: 100%;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r child="readFunc.Rmd"}
```

# Article information

Pupil response asymmetries of the periphery visual field in the glare illusion

Novera Istiqomah, Yuta Suzuki, Yuya Kinzuka, Minami Tetsuto, Shigeki Nakauchi

*Corresponding author: Yuta Suzuki



```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}
#### #### #### #### generate dataset file #### #### #### ####
# sTime = -1
# eTime = 4
# timeLen = c(sTime,eTime)
# nameOfVar = c("condition","condition")
# f1 = "Locs"
# f2 = "Pattern"
# 
# g1 <- rep(c("Upper","Lower","Center","Left","Right"),2)
# g2 <- rep(c("Glare","Control"),times=c(5,5))
# 
# go1 <- c("Upper","Lower","Center","Left","Right")
# go2 <- c("Glare","Control")
# 
# # #### making dataset for e1 #################################
# data=fromJSON(file="data/data2.json")
# dat <- list((matrix(unlist(data$PDR),nrow=length(data$PDR),byrow=T)),
#             t(unlist(data$sub)),
#             t(unlist(data$condition)))
# names(dat) <- c('y', 'sub', 'condition')
# 
# ind_data = makePupilDataset_mat2long(dat,c('condition','condition'),timeLen,list(g1,g2),list(go1,go2),c(f1,f2))
# 
# data_e1 = aggregate( . ~ sub*data_x*Locs*Pattern, data = ind_data, FUN = "mean")
# 
# save(data_e1,file = "data/dataset.rda")

## ##################################################

```

```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE, fig.height=10, fig.width=13}
##### Figure 2 #####
countFigNum = 1
SIZE_FONT=20
CairoFonts(regular = "Times","Times")
go1 <- c("Center","Upper","Lower","Left","Right")

######## file loading ######## 
load("./data/dataset.rda")
data_e1$Locs = factor(data_e1$Locs, go1)
numOfSub = length(unique(data_e1$sub))
sTime = -0.2
eTime = max(data_e1$data_x)

######## Figure 2A ######## 
data_e1_ave = aggregate( data_y ~ data_x*Locs*Pattern, data = data_e1, FUN = "mean")

config = list(lim_x = c(sTime, eTime),
              lim_y = c(-0.5, 0.7),
              alpha = 0.4,
              stride = 0.1,
              label_x = "Time [sec]",
              label_y = "Pupil Changes [z-scored]",
              title = "",
              linetype = TRUE,
              grCol = rep(c("#101010","#101010"),10),
              gr_outline =  rep(c("#101010","#101010"),10)
)

p <- disp(data_e1,config,1,c("Pattern","Locs"))
p <- p + 
  facet_grid(. ~ Locs)

config$ylim = round(seq(-0.5,0.75,0.25),2)
config$ylim_stride = 0.05
config$xlim = round(seq(0,4,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p = p +
  theme(
    axis.ticks = element_line(colour = "black",size = 0.5)
  )

# p = setFigureStyle(p,SIZE_FONT)

p <- p + theme(
  # legend.position = c(0.9,0.35),
  legend.text = element_text(size = 7),
  legend.position = c(1, 0),
  legend.justification = c(1, 0)
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

######## Figure 2B ######## 
# data_e1_0deg_min = tapply(data_e1$data_y,list(data_e1$sub),min)
data_e1_ave = data_e1[data_e1$data_x >= 0,]
data_e1_ave = aggregate( data_y ~ sub*Locs*Pattern, data = data_e1_ave, FUN = "mean")

# gName = c('glare top','glare bottom','glare center','glare left','glare right',
#           'control top' ,'control bottom','control center','control left','control right')
# 
# f = data.frame(
#   sub = as.character(unique(data_e1_anova$sub)),
#   y = matrix(data_e1_anova$data_y,nrow = numOfSub)
# )
# 
# colnames(f) <- c("subject",gName)
# write.csv(f, "[JASP]Bayesian/data_average.csv",row.names=FALSE)

data_e1_anova = data_e1_ave[data_e1_ave$Locs != 'Center',]
anovakun(data_e1_anova,"sAB",long=T, peta=T, gg=T)
fig2a_anovatable = forDrawingSigANOVA
fig2a_ttest = forDrawingPost[["A"]][["bontab"]]
fig2a_inter = forDrawingPost[["A:B"]][["simtab"]]

## cohen's d and BF ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
fig2a_cohend=NULL
fig2a_bf=NULL
comb = rbind(c('Upper','Upper','Upper'),c('Lower','Left','Right'))
for(iLocs in 1:3){
  x = apply(rbind(data_e1_anova[data_e1_anova$Locs == comb[1,iLocs] & data_e1_anova$Pattern == 'Glare',]$data_y,
                  data_e1_anova[data_e1_anova$Locs == comb[1,iLocs] & data_e1_anova$Pattern == 'Control',]$data_y),2, mean)
  y = apply(rbind(data_e1_anova[data_e1_anova$Locs == comb[2,iLocs] & data_e1_anova$Pattern == 'Glare',]$data_y,
                  data_e1_anova[data_e1_anova$Locs == comb[2,iLocs] & data_e1_anova$Pattern == 'Control',]$data_y),2, mean)
  
  n = length(x)
  sc = sqrt((n*(var(x))+n*(var(y)))/(n*2))
  fig2a_cohend = rbind(fig2a_cohend,round(abs(mean(x)-mean(y))/sc,3))
  bayesF = ttestBF(x = x, y = y, paired=TRUE)
  fig2a_bf = rbind(fig2a_bf,round(exp(bayesF@bayesFactor[["bf"]]),3))
}

fig2c_cohend=NULL
fig2c_bf=NULL
for(iLocs in 2:5){
  x = data_e1_anova[data_e1_anova$Locs == go1[iLocs] & data_e1_anova$Pattern == 'Glare',]$data_y
  y = data_e1_anova[data_e1_anova$Locs == go1[iLocs] & data_e1_anova$Pattern == 'Control',]$data_y
  
  n = length(x)
  sc = sqrt((n*(var(x))+n*(var(y)))/(n*2))
  fig2c_cohend = rbind(fig2c_cohend,round(abs(mean(x)-mean(y))/sc,3))
  bayesF = ttestBF(x = x, y = y, paired=TRUE)
  fig2c_bf = rbind(fig2c_bf,round(exp(bayesF@bayesFactor[["bf"]]),3))
}
## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
config$label_x = ''
config$title = "Averaged Pupil Changes [z-scored]"
data_e1_anova$sub = subName[data_e1_anova$sub]
config$grCol = rep(c("black","white"),5)
config$gr_outline = rep(c("black","black"),5)
p <- dispLineGraph(data_e1_ave,config,c("Locs","Pattern"))+
  # geom_point(data=data_e1_anova,aes(x = Pattern,y = data_y, group=interaction(Locs,sub)), color="black",alpha=0.2)+
  # geom_line(data=data_e1_anova,aes(x = Pattern,y = data_y, group=interaction(Locs,sub),color=sub),alpha=0.8)+
  facet_grid(. ~ Locs)

config$ylim = round(seq(-0.3,0.5,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p = p + theme(
  # axis.ticks = element_line(colour = "black",size = 0.5),
  axis.title.x=element_blank(),
  axis.text.x=element_blank(),
  axis.ticks.x = element_blank(),
  legend.position = c(1, 0),
  legend.justification = c(1, 0),
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

######## Figure 2C ######## 
data_e1_diff = data_e1_ave[data_e1_ave$Pattern == 'Glare',]
data_e1_diff$Pattern = NULL
data_e1_diff$data_y = data_e1_ave[data_e1_ave$Pattern == 'Glare',]$data_y - data_e1_ave[data_e1_ave$Pattern == 'Control',]$data_y

config$label_y = "Differences [z-scored]"
pVal=NULL
for(iLocs in 1:5){
  y = data_e1_diff[data_e1_diff$Locs == go1[iLocs],]$data_y
  model = t.test(y, mu=0)
  pVal = rbind(pVal,model[["p.value"]])
}

p <- dispLineGraph(data_e1_diff,config,c("Locs"))

p <- p + theme(
  legend.position = 'none'
)

config$ylim = round(seq(-0.3,0.1,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,5,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p = p +
  theme(
    axis.ticks = element_line(colour = "black",size = 0.5)
   )

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

#### figure output -----------------------------------------------------------

```

```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE, fig.height=8, fig.width=8}
##### Figure 3 #####
#### file loading #### 
# countFigNum = 1 
# load("data/dataset.rda")
# go1 <- c("Center","Upper","Lower","Left","Right")
# data_e1$Locs = factor(data_e1$Locs, go1)
# 
# numOfSub = length(unique(data_e1$sub))
# 
# peakMin = data_e1[data_e1$Locs == 'Center',]
# peakMin = aggregate( data_y ~ sub*data_x, data = peakMin, FUN = "mean")
# peakMin = aggregate( data_y ~ data_x, data = peakMin, FUN = "mean")
# peakMin_ind = peakMin[peakMin$data_y == min(peakMin$data_y),]$data_x
# 
# config = list(
#   alpha = 0.4,
#   stride = 0.1,
#   label_x = "",
#   label_y = "Pupil Changes [z-scored]",
#   title = ""
#  )
# #### Figure 3A #### 
# data_e1_early = data_e1[data_e1$data_x < peakMin_ind & data_e1$data_x > 0,]
# # data_e1_early = data_e1[data_e1$data_x > peakMin_ind-0.5 & data_e1$data_x < peakMin_ind+0.5,]
# data_e1_early = aggregate( data_y ~ sub*Locs*Pattern, data = data_e1_early, FUN = "mean")
# 
# diff = data_e1_early[data_e1_early$Pattern == 'Glare',]$data_y - data_e1_early[data_e1_early$Pattern == 'Control',]$data_y 
# # data_e1_early$data_y = data_e1_early[data_e1_early$Pattern == 'Glare',]$data_y
# # data_e1_early$data_y = diff
# # data_e1_early$Pattern = 'early'
# 
# pVal=NULL
# for(iLocs in 1:5){
#   y1 = data_e1_early[data_e1_early$Locs == go1[iLocs] & data_e1_early$Pattern == 'Glare',]$data_y
#   y2 = data_e1_early[data_e1_early$Locs == go1[iLocs] & data_e1_early$Pattern == 'Control',]$data_y
#   model = t.test(y1,y2,paired = TRUE)
#   pVal = rbind(pVal,model[["p.value"]])
# }
# 
# p <- dispLineGraph(data_e1_early,config,c("Locs","Pattern"))+
#   facet_grid(. ~ Locs)
# 
# config$ylim = round(seq(-0.15,0.15,0.05),2)
# config$ylim_stride = 0.02
# config$xlim = round(seq(1,2,1),2)
# config$xlim_stride = 0.5
# 
# p = setEmptyStyle(p,config)
# 
# eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
# countFigNum = countFigNum+1
# # data_e1_early_anova=data_e1_early
# data_e1_early_anova = data_e1_early[data_e1_early$Locs != 'Center',]
# # data_e1_early_anova$Pattern = NULL
# 
# #### Figure 3B #### 
# data_e1_late = data_e1[data_e1$data_x > peakMin_ind,]
# data_e1_late = aggregate( data_y ~ sub*Locs*Pattern, data = data_e1_late, FUN = "mean")
# # diff = data_e1_late[data_e1_late$Pattern == 'Glare',]$data_y - data_e1_late[data_e1_late$Pattern == 'Control',]$data_y 
# # data_e1_late$data_y = data_e1_late[data_e1_late$Pattern == 'Glare',]$data_y
# # data_e1_late$data_y = diff
# # data_e1_late$Pattern = 'late'
# 
# # data_e1_late = rbind(data_e1_early,data_e1_late)
# p <- dispLineGraph(data_e1_late,config,c("Locs","Pattern"))+
#   facet_grid(. ~ Locs)
# 
# config$ylim = round(seq(-0.4,0.6,0.2),2)
# config$ylim_stride = 0.05
# config$xlim = round(seq(1,2,1),2)
# config$xlim_stride = 0.5
# 
# p = setEmptyStyle(p,config)
# 
# eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
# countFigNum = countFigNum+1
# 
# # p <- dispLineGraph(data_e1_late,config,c("Pattern","Locs"))+
# #   facet_grid(Pattern ~ .)
# # data_e1_late_anova=data_e1_late
# data_e1_late_anova = data_e1_late[data_e1_late$Locs != 'Center',]
# # data_e1_early$comp = 'early'
# # 
# # p <- dispLineGraph(data_comp,config,c("Locs","Pattern","comp"))+
# #   facet_grid(comp ~ Pattern)
# 
# anovakun(data_e1_early_anova,"sAB",long=T, peta=T, gg=T)
# fig3a_anovatable = forDrawingSigANOVA
# fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
# fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]
# 
# anovakun(data_e1_late_anova,"sAB",long=T, peta=T, gg=T)
# fig3b_anovatable = forDrawingSigANOVA
# fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
# fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]



#### file loading #### 
# countFigNum = 1 
load("data/dataset.rda")
go1 <- c("Center","Upper","Lower","Left","Right")
data_e1$Locs = factor(data_e1$Locs, go1)

numOfSub = length(unique(data_e1$sub))

peakMin = data_e1[data_e1$Locs == 'Center',]
peakMin = aggregate( data_y ~ sub*data_x, data = peakMin, FUN = "mean")
peakMin = aggregate( data_y ~ data_x, data = peakMin, FUN = "mean")
peakMin_ind = peakMin[peakMin$data_y == min(peakMin$data_y),]$data_x

data_auc = data.frame()
for(iSub in unique(data_e1$sub)){
  for(iLocs in unique(data_e1$Locs)){
    for(iPattern in unique(data_e1$Pattern)){
      tmp = data_e1[data_e1$sub == iSub &
                      data_e1$Locs == iLocs &
                      data_e1$Pattern == iPattern &
                      data_e1$data_x > peakMin_ind,]
      
      auc = 0
      peakMin = mean(data_e1[data_e1$sub == iSub &
                               data_e1$Locs == iLocs &
                               data_e1$Pattern == iPattern &
                               data_e1$data_x < peakMin_ind+0.25 &
                               data_e1$data_x > peakMin_ind-0.25,]$data_y)
      
      for(ix in 1:(length(tmp$data_x)-1)){
        auc = auc + mean(c(tmp[ix+1,]$data_y,tmp[ix,]$data_y)-peakMin)
      }
      data_auc = rbind(data_auc,data.frame(
        sub = iSub,
        Locs = iLocs,
        Pattern = iPattern,
        data_y = c(peakMin,auc),
        comp = c('Early','Late')
      ))
    }
  }
}
data_auc$Locs = factor(data_auc$Locs, go1)

config = list(
  alpha = 0.4,
  stride = 0.1,
  label_x = "",
  label_y = "PLR",
  title = ""
)

config$grCol = rep(c("black","white"),5)
config$gr_outline = rep(c("black","black"),5)
p <- dispLineGraph(data_auc[data_auc$comp == 'Early',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Early')

config$ylim = round(seq(-0.6,0.2,0.2),2)
config$ylim_stride = 0.1
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

config$label_y = "AUC"
p <- dispLineGraph(data_auc[data_auc$comp == 'Late',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Late(AUC)')

config$ylim = round(seq(0,600,200),2)
config$ylim_stride = 100
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

data_auc = data_auc[data_auc$Locs != 'Center',]
data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]

data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]
```

```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}
# data=fromJSON(file="data/events.json")
# g1 <- c("Upper","Lower","Center","Left","Right","Upper","Lower","Center","Left","Right")
# g2 <- c("Glare","Glare","Glare","Glare","Glare","Control","Control","Control","Control","Control")
# ind_data = data.frame(
#   sub = data$sub,
#   Locs = g1[data$condition],
#   Pattern = g2[data$condition],
#   data_y = c(data$diff_f0,data$diff_f1),
#   f = rep(c('f0','f1'),times=c(length(data$diff_f0),length(data$diff_f1)))
# )
# 
# f0_anova = ind_data[ind_data$f == 'f1',]
# f0_anova$f = NULL
# anovakun(f0_anova,"sAB",long=T, peta=T, gg=T)
# 
# 
# p <- dispLineGraph(ind_data,config,c("Pattern","Locs","f"))+
#   facet_grid(f ~ Locs)

# data=fromJSON(file="data/dat_loadings.json")

# 
# ind_data = data.frame(
#   sub = data$sub,
#   Locs = g1[data$locs],
#   Pattern = g2[data$pattern+1],
#   data_y = data$compornent,
#   cNum = data$cnum 
# )
# # ind_data = ind_data[ind_data$cNum == 1,]
# 
# p <- dispLineGraph(ind_data,config,c("Pattern","Locs","cNum"))+
#   facet_grid(cNum ~ Locs)
# ind_data$cNum = NULL
# anovakun(ind_data,"sAB",long=T, peta=T, gg=T)

# # comparison with center
# countFigNum = 1
# SIZE_FONT=20
# CairoFonts(regular = "Times","Times")
# 
# #### file loading 
# load("data/dataset.rda")
# 
# data_e1 = data_e1[data_e1$data_x > 0,]
# # data_e1 = data_e1[data_e1$sub != 10,]
# 
# data_e1_ave = aggregate( data_y ~ sub*Locs*Pattern, data = data_e1, FUN = "mean")
# 
# diff = exp(data_e1_ave[data_e1_ave$Pattern == "Control" & data_e1_ave$Locs != "Center",]$data_y - data_e1_ave[data_e1_ave$Pattern == "Glare" & data_e1_ave$Locs != "Center",]$data_y)
# 
# center =  exp(data_e1_ave[data_e1_ave$Pattern == "Glare" & data_e1_ave$Locs == "Center",]$data_y - data_e1_ave[data_e1_ave$Pattern == "Control" & data_e1_ave$Locs == "Center",]$data_y)
# 
# data_e1_ave = data_e1_ave[data_e1_ave$Pattern == "Glare" & data_e1_ave$Locs != "Center",]
# # data_e1_ave$diff = diff
# data_e1_ave$data_y = diff / center
# data_e1_ave$Pattern = NULL
# # data_e1_ave$center = center 
# 
# # data_e1_ave_high = data_e1_ave[data_e1_ave$center > mean(center), ]
# # 
# # p <- dispLineGraph(data_e1_ave_high,config,c("Locs"))
# # print(p)
# anovakun(data_e1_ave,"sA",long=T, peta=T,gg=T)
# 
# # data_e1_ave$center = center
# # data_e1_ave$sub = subName[data_e1_ave$sub]
# # p = ggplot(data_e1_ave,aes(x = center,y = diff,group = Locs,color=sub))+
# #   geom_point(aes(shape=Locs),size=4)
# 
# # model = lmer( center ~ diff+(1+diff|Locs),data_e1_ave)
# # summary(model)
# 
# # facet_grid(. ~ Locs)
# 
# # data_e1_ave = aggregate( . ~ Locs*Pattern, data = data_e1_ave, FUN = "mean")
# 
# # data_e1_ave$data_y = data_e1_ave$center / data_e1_ave$data_y
# # mean(data_e1_ave[data_e1_ave$Locs == 'Top',]$data_y)
# 
# data_e1_ave$Pattern = NULL
# 
# config = list(alpha = 0.4,
#               stride = 0.1,
#               label_x = "Time [sec]",
#               label_y = "Pupil Change[%]",
#               title = "",
#               linetype = TRUE
# )
# p <- dispLineGraph(data_e1_ave,config,c("Locs"))
# print(p)

```

# Results
We presented a stimulus (glare or control stimuli) in four visual positions (i.e., upper, lower, left, and right). As shown in Fig.3, the pupillary trace demonstrated a prominent constriction approximately after 500 ms of stimulus onset (PLR), which was in response to the visual stimulus (glare illusion or control stimuli) presentation on the gray background __(Bombeke et al., 2016; Laeng et al., 2018; Laeng & Endestad, 2012; Zavagno et al., 2017)__. After reaching the PLR amplitude peak, the pupil gradually dilates, reflecting cognitive factors, including perceptual brightness of the stimuli. Fig. 3a portrays pupil size changes from stimulus onset to offset across all observers in each visual field. 

### The stimulus-evoked pupillary responses in glare illusion and control pattern
We calculated the average pupil diameter change during the presentation of stimuli in each pattern and visual position, as displayed in Fig. 3B. Two-way repeated measures ANOVAs on the average pupil change performed in each pattern and visual position. There was a significant main effect of visual position 
($F$(`r round(fig2a_anovatable[2,]['df.col'],3)`, `r round(fig2a_anovatable[3,]['df.col'],3)`) = `r round(fig2a_anovatable[2,]['f.col'],3)`, p = `r round(fig2a_anovatable[2,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig2a_anovatable[2,]['p.eta^2'],3)`).
Post-hoc comparisons demonstrated significant differences between upper-lower, -left, and -right positions 
(t(`r round(fig2a_ttest[1,]['df'],3)`) = `r round(fig2a_ttest[1,]['t'],3)`,p = `r round(fig2a_ttest[1,]['adj.p'],3)`, Cohen’s  $d$ = `r fig2a_cohend[1]`, $BF_{10}$ =  `r fig2a_bf[1]`,
t(`r round(fig2a_ttest[2,]['df'],3)`) = `r round(fig2a_ttest[2,]['t'],3)`,p =  `r round(fig2a_ttest[2,]['adj.p'],3)`, Cohen’s  $d$ = `r fig2a_cohend[2]`, $BF_{10}$ =  `r fig2a_bf[2]`, 
t(`r round(fig2a_ttest[3,]['df'],3)`) = `r round(fig2a_ttest[3,]['t'],3)`,p =  `r round(fig2a_ttest[3,]['adj.p'],3)`, Cohen’s  $d$ = `r fig2a_cohend[3]`, $BF_{10}$ =  `r fig2a_bf[3]` respectively), 
indicating that the UVF produces larger pupil dilation than the other visual field regardless of the stimulus pattern, in line with the previous studies __(Hong et al., 2001; Sabeti et al., 2011; Tan et al., 2001; Wilhelm et al., 2000)__. 
The main effect of the pattern and the interaction between pattern and visual position were not significant 
($F$(`r round(fig2a_anovatable[4,]['df.col'],3)`, `r round(fig2a_anovatable[5,]['df.col'],3)`) = `r round(fig2a_anovatable[4,]['f.col'],3)`, p = `r round(fig2a_anovatable[4,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig2a_anovatable[4,]['p.eta^2'],3)`,
$F$(`r round(fig2a_anovatable[6,]['df.col'],3)`, `r round(fig2a_anovatable[7,]['df.col'],3)`) = `r round(fig2a_anovatable[6,]['f.col'],3)`, p = `r round(fig2a_anovatable[6,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig2a_anovatable[6,]['p.eta^2'],3)`, respectively). 
Following multiple comparisons showed that the differences of pupil response between glare and control stimuli in the upper position had significant effect with medium effect of Cohen’s d 
(t(`r round(fig2a_inter[6,]['df.col'],3)`) = `r round(fig2a_inter[5,]['f.col'],3)`,p = `r round(fig2a_inter[5,]['p.col'],3)`, Cohen’s  $d$ = `r fig2c_cohend[1]`, $BF_{10}$ =  `r fig2c_bf[1]`).
However, the differences between pattern in the lower, left, and right positions had no significant effects with small effects of Cohen’s d 
(t(`r round(fig2a_inter[8,]['df.col'],3)`) = `r round(fig2a_inter[7,]['f.col'],3)`,p = `r round(fig2a_inter[7,]['p.col'],3)`, Cohen’s  $d$ = `r fig2c_cohend[2]`, $BF_{10}$ =  `r fig2c_bf[2]`,
t(`r round(fig2a_inter[10,]['df.col'],3)`) = `r round(fig2a_inter[9,]['f.col'],3)`,p = `r round(fig2a_inter[9,]['p.col'],3)`, Cohen’s  $d$ = `r fig2c_cohend[3]`, $BF_{10}$ =  `r fig2c_bf[3]`,
t(`r round(fig2a_inter[12,]['df.col'],3)`) = `r round(fig2a_inter[11,]['f.col'],3)`,p = `r round(fig2a_inter[11,]['p.col'],3)`, Cohen’s  $d$ = `r fig2c_cohend[4]`, $BF_{10}$ =  `r fig2c_bf[4]`, respectively).


### Early and late compornents
($F$(`r round(fig3a_anovatable[2,]['df.col'],3)`, `r round(fig3a_anovatable[3,]['df.col'],3)`) = `r round(fig3a_anovatable[2,]['f.col'],3)`, p = `r round(fig3a_anovatable[2,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3a_anovatable[2,]['p.eta^2'],3)`,
$F$(`r round(fig3a_anovatable[4,]['df.col'],3)`, `r round(fig3a_anovatable[5,]['df.col'],3)`) = `r round(fig3a_anovatable[4,]['f.col'],3)`, p = `r round(fig3a_anovatable[4,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3a_anovatable[4,]['p.eta^2'],3)`,
$F$(`r round(fig3a_anovatable[6,]['df.col'],3)`, `r round(fig3a_anovatable[7,]['df.col'],3)`) = `r round(fig3a_anovatable[6,]['f.col'],3)`, p = `r round(fig3a_anovatable[6,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3a_anovatable[6,]['p.eta^2'],3)`, respectively). 


($F$(`r round(fig3b_anovatable[2,]['df.col'],3)`, `r round(fig3b_anovatable[3,]['df.col'],3)`) = `r round(fig3b_anovatable[2,]['f.col'],3)`, p = `r round(fig3b_anovatable[2,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3b_anovatable[2,]['p.eta^2'],3)`,
$F$(`r round(fig3b_anovatable[4,]['df.col'],3)`, `r round(fig3b_anovatable[5,]['df.col'],3)`) = `r round(fig3b_anovatable[4,]['f.col'],3)`, p = `r round(fig3b_anovatable[4,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3b_anovatable[4,]['p.eta^2'],3)`,
$F$(`r round(fig3b_anovatable[6,]['df.col'],3)`, `r round(fig3b_anovatable[7,]['df.col'],3)`) = `r round(fig3b_anovatable[6,]['f.col'],3)`, p = `r round(fig3b_anovatable[6,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3b_anovatable[6,]['p.eta^2'],3)`, respectively). 

# Figure 2
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=10, fig.width=13}
layout <- rbind(c(1,1),c(2,3))
p = combineGraphs(seq(1,3),'p',layout)
width_fig=13
height_fig=10
ggsave(file = "figure/fig2.pdf",
       plot = p, dpi = 500,
       width = width_fig, height = height_fig,
       family="Times")

```

# Figure 3
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=5, fig.width=13}
p = combineGraphs(seq(4,5),'p',NULL)
width_fig=13
height_fig=6
CairoPDF(file="figure/fig3",
         width=width_fig, height=height_fig)
print(p)
dev.off()
```